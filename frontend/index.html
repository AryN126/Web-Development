<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Taskly</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
:root{
  --bg:#0b0d14;
  --card:rgba(255,255,255,0.06);
  --border:rgba(255,255,255,0.08);
  --accent:#4f7cff;
  --green:#22c55e;
  --yellow:#facc15;
  --purple:#a855f7;
  --red:#ef4444;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:"Inter",system-ui,sans-serif;
  background:radial-gradient(circle at top,#151826,#090b12);
  color:var(--text);
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

.hidden{display:none}

/* NAV */
nav{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px 28px;
  background:rgba(10,12,20,.85);
  backdrop-filter:blur(12px);
  position:sticky;
  top:0;
  z-index:10;
}

.logo-container{
  display:flex;
  align-items:center;
  gap:12px;
}

.logo{
  height:52px;
  width:auto;
}

nav a{
  color:var(--text);
  text-decoration:none;
  margin-left:15px;
  padding:8px 14px;
  border-radius:10px;
}
nav a:hover{background:var(--accent);}

/* LAYOUT */
.container{
  max-width:1200px;
  margin:auto;
  padding:30px;
}

/* GLASS CARD */
.card{
  background:var(--card);
  backdrop-filter:blur(14px);
  border:1px solid var(--border);
  border-radius:22px;
  padding:22px;
  box-shadow:0 30px 60px rgba(0,0,0,.45);
}

/* HOME */
#home .card{
  text-align:center;
  padding:60px;
}
#home h1{font-size:40px}
#home p{color:var(--muted);font-size:1.1rem}

/* INPUTS */
input,select{
  width:100%;
  padding:12px;
  margin-top:10px;
  background:#0b0d14;
  border:1px solid var(--border);
  border-radius:14px;
  color:var(--text);
}

/* BUTTONS */
button{
  margin-top:14px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:linear-gradient(135deg,#4f7cff,#22c55e);
  color:#fff;
  font-weight:600;
  cursor:pointer;
  transition:.25s;
}
button:hover{
  transform:translateY(-2px);
  box-shadow:0 10px 30px rgba(79,124,255,.4);
}
button.small{
  width:auto;
  padding:6px 12px;
  font-size:.8rem;
}

/* DASHBOARD */
.dashboard-grid{
  display:grid;
  grid-template-columns:1.2fr 2fr;
  gap:25px;
}

/* STATS */
.stats{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:15px;
  margin-bottom:25px;
}
.stat{
  border-radius:18px;
  padding:18px;
  text-align:center;
}
.stat.total{background:linear-gradient(135deg,#4f7cff,#1e40af);}
.stat.done{background:linear-gradient(135deg,#22c55e,#15803d);}
.stat.pending{background:linear-gradient(135deg,#facc15,#a16207);}
.stat.progress{background:linear-gradient(135deg,#a855f7,#6b21a8);}

/* TASKS */
.task{
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px;
  border-radius:18px;
  background:rgba(255,255,255,0.05);
  border:1px solid var(--border);
  margin-top:12px;
  justify-content:space-between;
}
.task.overdue{border-left:5px solid var(--red);}
.completed{text-decoration:line-through;opacity:.6}

.task-left{display:flex;align-items:center;gap:10px;}
.badge{
  padding:6px 12px;
  border-radius:999px;
  font-size:.7rem;
  text-transform:uppercase;
}
.work{background:#3b82f6;}
.study{background:#a855f7;}
.personal{background:#22c55e;}

/* FOOTER */
footer{
  margin-top:auto;
  background:linear-gradient(135deg,#070a14,#11162a);
  padding:25px 8%;
}
.footer-container{
  display:flex;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:40px;
}
.footer-column h3{margin-bottom:15px}
.footer-column ul{list-style:none;padding:0}
.footer-column ul li{margin-bottom:10px}
.footer-column ul li a{
  color:var(--muted);
  text-decoration:none;
  cursor:pointer;
}
.footer-column ul li a:hover{color:#fff}
.social-icons a{
  color:#fff;
  font-size:20px;
  margin-right:15px;
}
.social-icons a:hover{color:var(--accent)}

@media(max-width:900px){
  .dashboard-grid{grid-template-columns:1fr}
  .stats{grid-template-columns:repeat(2,1fr)}
  .logo{height:44px}
}

/* MOBILE NAV + FOOTER FIX */
@media (max-width: 600px){
  nav{
    flex-direction: column;
    gap: 12px;
    padding: 16px;
  }
  nav .logo-container{justify-content: center;}
  nav div:last-child{
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
  }
  nav a{
    margin: 0;
    padding: 8px 14px;
    font-size: 0.9rem;
    border-radius: 12px;
    background: rgba(255,255,255,0.05);
  }
  #home .card{padding: 40px 25px;}
  #home h1{font-size: 28px;}
  footer{padding:14px 8%;}
  .footer-container{gap:24px;}
  .footer-column h3{margin-bottom:8px;font-size:0.95rem;}
  .footer-column ul li{margin-bottom:6px;font-size:0.85rem;}
  .social-icons a{font-size:18px;margin-right:10px;}
}
</style>
</head>

<body>

<!-- NAV -->
<nav>
  <div class="logo-container">
    <img src="imgs/taskly logo.png" alt="Taskly Logo" class="logo">
  </div>
  <div>
    <a href="#" data-page="home">Home</a>
    <a href="#" data-page="signup">Signup</a>
    <a href="#" data-page="login">Login</a>
  </div>
</nav>

<!-- HOME -->
<section id="home" class="container page">
  <div class="card">
    <h1>Welcome to Taskly</h1>
    <p>Manage tasks, track progress and stay productive.</p>
    <button onclick="showPage('signup')">Get Started</button>
  </div>
</section>

<!-- SIGNUP -->
<section id="signup" class="container page hidden">
  <div class="card">
    <h2>Sign Up</h2>
    <input id="signupName" placeholder="Full Name">
    <input id="signupEmail" placeholder="Email">
    <input id="signupPassword" type="password" placeholder="Password">
    <button id="signupBtn">Create Account</button>
  </div>
</section>

<!-- LOGIN -->
<section id="login" class="container page hidden">
  <div class="card">
    <h2>Login</h2>
    <input id="loginEmail" placeholder="Email">
    <input id="loginPassword" type="password" placeholder="Password">
    <button id="loginBtn">Login</button>
  </div>
</section>

<!-- DASHBOARD -->
<section id="dashboard" class="container page hidden">

  <div class="card" style="margin-bottom:25px">
    <h2>Hello</h2>
    <h1>Good Morning</h1>
    <p style="color:var(--muted)">Here’s your productivity overview</p>
  </div>

  <div class="stats">
    <div class="stat total"><h3 id="totalCount">0</h3>Total</div>
    <div class="stat done"><h3 id="doneCount">0</h3>Completed</div>
    <div class="stat pending"><h3 id="pendingCount">0</h3>Pending</div>
    <div class="stat progress"><h3 id="progressPercent">0%</h3>Progress</div>
  </div>

  <div class="dashboard-grid">
    <div class="card">
      <h3>Add Task</h3>
      <input id="taskText" placeholder="Task name">
      <input id="taskDate" type="date">
      <select id="taskCategory">
        <option value="work">Work</option>
        <option value="study">Study</option>
        <option value="personal">Personal</option>
      </select>
      <select id="taskPriority">
        <option>Low</option>
        <option selected>Medium</option>
        <option>High</option>
      </select>
      <button id="addTaskBtn">Add Task</button>
    </div>

    <div>
      <select id="filterCategory">
        <option value="all">All Categories</option>
        <option value="work">Work</option>
        <option value="study">Study</option>
        <option value="personal">Personal</option>
      </select>
      <div id="taskList"></div>
    </div>
  </div>

</section>

<!-- FOOTER -->
<footer>
  <div class="footer-container">
    <div class="footer-column">
      <h3>Explore</h3>
      <ul>
        <li><a onclick="showPage('home')">Home</a></li>
        <li><a onclick="showPage('signup')">Signup</a></li>
      </ul>
    </div>

    <div class="footer-column">
      <h3>Company</h3>
      <ul>
        <li><a href="javascript:void(0)">About</a></li>
        <li><a href="javascript:void(0)">Press</a></li>
        <li><a href="javascript:void(0)">FAQs</a></li>
      </ul>
    </div>

    <div class="footer-column">
      <h3>Follow Us</h3>
      <div class="social-icons">
        <a href="javascript:void(0)"><i class="fab fa-facebook"></i></a>
        <a href="javascript:void(0)"><i class="fab fa-twitter"></i></a>
        <a href="javascript:void(0)"><i class="fab fa-instagram"></i></a>
        <a href="javascript:void(0)"><i class="fab fa-youtube"></i></a>
      </div>
    </div>

  </div>
</footer>

<script>
const API_BASE = "http://localhost:4000/api";
let token = null;
let tasks = [];
const pages = document.querySelectorAll(".page");

// DOM Elements
const signupBtn = document.getElementById("signupBtn");
const loginBtn = document.getElementById("loginBtn");
const addTaskBtn = document.getElementById("addTaskBtn");
const signupName = document.getElementById("signupName");
const signupEmail = document.getElementById("signupEmail");
const signupPassword = document.getElementById("signupPassword");
const loginEmail = document.getElementById("loginEmail");
const loginPassword = document.getElementById("loginPassword");
const taskText = document.getElementById("taskText");
const taskDate = document.getElementById("taskDate");
const taskCategory = document.getElementById("taskCategory");
const taskPriority = document.getElementById("taskPriority");
const filterCategory = document.getElementById("filterCategory");
const taskList = document.getElementById("taskList");
const totalCount = document.getElementById("totalCount");
const doneCount = document.getElementById("doneCount");
const pendingCount = document.getElementById("pendingCount");
const progressPercent = document.getElementById("progressPercent");

// Show page function
function showPage(id){
  pages.forEach(p=>p.classList.add("hidden"));
  const page = document.getElementById(id);
  if(page) page.classList.remove("hidden");
}

// Nav links
document.querySelectorAll("nav a[data-page]").forEach(a=>{
  a.onclick = e => { e.preventDefault(); showPage(a.dataset.page); }
});

/* SIGNUP */
signupBtn.onclick = async () => {
  const name = signupName.value.trim();
  const email = signupEmail.value.trim();
  const password = signupPassword.value.trim();
  if (!name || !email || !password) return alert("All fields required");

  try {
    const r = await fetch(`${API_BASE}/users/register`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, email, password })
    });
    const d = await r.json();
    if (r.ok) {
      alert("Account Created!");
      token = d.token;
      showPage("dashboard");
      fetchTasks();
    } else {
      alert(d.message || "Signup failed");
    }
  } catch (e) {
    console.error(e);
    alert("Server error");
  }
};

/* LOGIN */
loginBtn.onclick = async () => {
  const email = loginEmail.value.trim();
  const password = loginPassword.value.trim();
  if (!email || !password) return alert("All fields required");

  try {
    const r = await fetch(`${API_BASE}/users/login`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });
    const d = await r.json();
    if (r.ok) {
      alert("Login Successful!");
      token = d.token;
      showPage("dashboard");
      fetchTasks();
    } else {
      alert(d.message || "Login failed");
    }
  } catch (e) {
    console.error(e);
    alert("Server error");
  }
};

/* TASKS */
async function fetchTasks(){
  if(!token) return;
  try{
    const r = await fetch(`${API_BASE}/tasks`, {
      headers:{ Authorization:`Bearer ${token}` }
    });
    if(!r.ok) throw new Error("Failed to fetch tasks");
    tasks = await r.json();
    renderTasks();
  }catch(e){console.error(e); alert("Failed to fetch tasks")}
}

function renderTasks(){
  taskList.innerHTML="";
  let done=0;
  tasks
    .filter(t=>filterCategory.value==="all"||t.cat===filterCategory.value)
    .forEach(t=>{
      if(t.completed) done++;
      const d = document.createElement("div");
      d.className = `task ${t.completed?"completed":""}`;
      d.innerHTML = `
        <div class="task-left">
          <input type="checkbox" ${t.completed?"checked":""}>
          <span>${t.title}<br><small>${t.date}</small></span>
          <span class="badge ${t.cat}">${t.cat}</span>
        </div>
        <div>
          <button class="small edit">✎</button>
          <button class="small delete">✕</button>
        </div>
      `;
      d.querySelector("input").onclick = ()=>toggleTask(t._id,t.completed);
      d.querySelector(".delete").onclick = ()=>deleteTask(t._id);
      d.querySelector(".edit").onclick = ()=>{
        const newTitle = prompt("Edit task title:", t.title);
        if(!newTitle) return;
        const newDate = prompt("Edit date:", t.date);
        const newCat = prompt("Edit category (work/study/personal):", t.cat);
        const newPriority = prompt("Edit priority (Low/Medium/High):", t.priority);
        editTask(t._id,newTitle,newDate,newCat,newPriority);
      }
      taskList.appendChild(d);
    });

  totalCount.textContent = tasks.length;
  doneCount.textContent = done;
  pendingCount.textContent = tasks.length - done;
  progressPercent.textContent = tasks.length?Math.round(done/tasks.length*100)+"%":"0%";
}

/* CRUD */
async function toggleTask(id,done){
  await fetch(`${API_BASE}/tasks/${id}`,{
    method:"PUT",
    headers:{
      Authorization:`Bearer ${token}`,
      "Content-Type":"application/json"
    },
    body: JSON.stringify({completed:!done})
  });
  fetchTasks();
}

async function deleteTask(id){
  await fetch(`${API_BASE}/tasks/${id}`,{
    method:"DELETE",
    headers:{ Authorization:`Bearer ${token}` }
  });
  fetchTasks();
}

async function editTask(id,title,date,cat,priority){
  await fetch(`${API_BASE}/tasks/${id}`,{
    method:"PUT",
    headers:{
      Authorization:`Bearer ${token}`,
      "Content-Type":"application/json"
    },
    body: JSON.stringify({title,date,cat,priority})
  });
  fetchTasks();
}

addTaskBtn.onclick = async () => {
  if(!taskText.value) return;
  await fetch(`${API_BASE}/tasks`,{
    method:"POST",
    headers:{
      Authorization:`Bearer ${token}`,
      "Content-Type":"application/json"
    },
    body:JSON.stringify({
      title:taskText.value,
      date:taskDate.value,
      cat:taskCategory.value,
      priority:taskPriority.value
    })
  });
  taskText.value="";
  taskDate.value="";
  fetchTasks();
};

filterCategory.onchange = renderTasks;

</script>
</body>
</html>
